/*
SNAKE 04 D0 B0 18 6F 61 80
04 CE 5D 75 8F 61 80
04 83 DF 18 6F 61 80
04 11 F2 18 6F 61 80
04 9E 60 72 8F 61 80
04 32 23 73 8F 61 80
*/

//RFID
#include <SPI.h>
#include <MFRC522.h>
#define SS_PIN 53
#define RST_PIN 5
MFRC522 rfid(SS_PIN, RST_PIN); // Instance of the class
MFRC522::MIFARE_Key key; 
// Init array that will store new NUID 
byte nuidPICC[4];
// Number of known default keys (hard-coded)
// NOTE: Synchronize the NR_KNOWN_KEYS define with the defaultKeys[] array
#define NR_KNOWN_KEYS 6
byte knownKeys[NR_KNOWN_KEYS][10] =  {
    {0x04, 0xD0, 0xB0, 0x18, 0x6F, 0x61, 0x80}, // SNAKE
    {0x04, 0xCE, 0x5D, 0x75, 0x8F, 0x61, 0x80}, //
    {0x04, 0x83, 0xDF, 0x18, 0x6F, 0x61, 0x80}, //
    {0x04, 0x11, 0xF2, 0x18, 0x6F, 0x61, 0x80}, //
    {0x04, 0x9E, 0x60, 0x72, 0x8F, 0x61, 0x80}, //
    {0x04, 0x32, 0x23, 0x73, 0x8F, 0x61, 0x80}, //
};
//RFID

//LED ARRAY
#include <FastLED.h>
#define NUM_LEDS 64
#define DATA_PIN 10
CRGB leds[NUM_LEDS];
int Snake [64][3]{{0, 0, 0}, {106, 190, 48}, {0, 0, 0}, {106, 190, 48}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{106, 190, 48}, {95, 12, 12}, {106, 190, 48}, {95, 12, 12}, {106, 190, 48}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{106, 190, 48}, {106, 190, 48}, {106, 190, 48}, {106, 190, 48}, {106, 190, 48}, {0, 0, 0}, {106, 190, 48}, {106, 190, 48}, 
{0, 0, 0}, {255, 255, 255}, {172, 50, 50}, {255, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {106, 190, 48}, 
{0, 0, 0}, {106, 190, 48}, {153, 229, 80}, {106, 190, 48}, {0, 0, 0}, {0, 0, 0}, {106, 190, 48}, {106, 190, 48}, 
{0, 0, 0}, {106, 190, 48}, {153, 229, 80}, {106, 190, 48}, {0, 0, 0}, {0, 0, 0}, {106, 190, 48}, {153, 229, 80}, 
{0, 0, 0}, {106, 190, 48}, {153, 229, 80}, {106, 190, 48}, {106, 190, 48}, {106, 190, 48}, {106, 190, 48}, {153, 229, 80}, 
{0, 0, 0}, {106, 190, 48}, {153, 229, 80}, {153, 229, 80}, {153, 229, 80}, {153, 229, 80}, {153, 229, 80}, {153, 229, 80}};
int Turtle [64][3]{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {17, 109, 71}, {55, 148, 110}, {17, 109, 71}, {0, 0, 0}, {153, 229, 80}, {153, 229, 80}, {0, 0, 0}, 
{17, 109, 71}, {55, 148, 110}, {17, 109, 71}, {55, 148, 110}, {55, 148, 110}, {153, 229, 80}, {102, 57, 49}, {153, 229, 80}, 
{17, 109, 71}, {17, 109, 71}, {55, 148, 110}, {17, 109, 71}, {238, 195, 154}, {153, 229, 80}, {153, 229, 80}, {153, 229, 80}, 
{198, 150, 104}, {238, 195, 154}, {198, 150, 104}, {238, 195, 154}, {198, 150, 104}, {238, 195, 154}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {153, 229, 80}, {153, 229, 80}, {0, 0, 0}, {153, 229, 80}, {153, 229, 80}, {0, 0, 0}, {0, 0, 0}};
int Snail [64][3]{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{217, 160, 102}, {0, 0, 0}, {217, 160, 102}, {0, 0, 0}, {143, 86, 59}, {143, 86, 59}, {143, 86, 59}, {0, 0, 0}, 
{238, 195, 154}, {0, 0, 0}, {238, 195, 154}, {143, 86, 59}, {143, 86, 59}, {102, 57, 49}, {143, 86, 59}, {143, 86, 59}, 
{238, 195, 154}, {238, 195, 154}, {238, 195, 154}, {143, 86, 59}, {102, 57, 49}, {143, 86, 59}, {143, 86, 59}, {102, 57, 49}, 
{0, 0, 0}, {238, 195, 154}, {238, 195, 154}, {143, 86, 59}, {143, 86, 59}, {102, 57, 49}, {102, 57, 49}, {73, 28, 20}, 
{0, 0, 0}, {217, 160, 102}, {238, 195, 154}, {238, 195, 154}, {73, 28, 20}, {73, 28, 20}, {73, 28, 20}, {0, 0, 0}, 
{0, 0, 0}, {217, 160, 102}, {217, 160, 102}, {217, 160, 102}, {217, 160, 102}, {217, 160, 102}, {217, 160, 102}, {217, 160, 102}};
int Fox [64][3]{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{255, 255, 255}, {255, 255, 255}, {0, 0, 0}, {0, 0, 0}, {223, 113, 38}, {0, 0, 0}, {223, 113, 38}, {0, 0, 0}, 
{255, 255, 255}, {223, 113, 38}, {0, 0, 0}, {0, 0, 0}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, 
{223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {0, 0, 0}, {223, 113, 38}, {74, 33, 5}, {223, 113, 38}, {74, 33, 5}, 
{223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {255, 255, 255}, {0, 0, 0}, {255, 255, 255}, 
{0, 0, 0}, {0, 0, 0}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {0, 0, 0}, 
{0, 0, 0}, {0, 0, 0}, {202, 96, 25}, {223, 113, 38}, {202, 96, 25}, {223, 113, 38}, {202, 96, 25}, {0, 0, 0}, 
{0, 0, 0}, {0, 0, 0}, {115, 53, 10}, {0, 0, 0}, {115, 53, 10}, {0, 0, 0}, {115, 53, 10}, {0, 0, 0}};
int Chicken [64][3]{{0, 0, 0}, {0, 0, 0}, {255, 0, 0}, {255, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{251, 242, 54}, {251, 242, 54}, {255, 255, 255}, {0, 0, 185}, {255, 255, 255}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {255, 0, 0}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, 
{255, 0, 0}, {255, 255, 255}, {255, 0, 0}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {201, 246, 255}, 
{0, 0, 0}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {201, 246, 255}, {201, 246, 255}, {201, 246, 255}, {255, 255, 255}, 
{0, 0, 0}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, {255, 255, 255}, 
{0, 0, 0}, {0, 0, 0}, {251, 242, 54}, {251, 242, 54}, {0, 0, 0}, {251, 242, 54}, {251, 242, 54}, {0, 0, 0}};
int Cat [64][3]{{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {223, 113, 38}, {0, 0, 0}, {223, 113, 38}, {0, 0, 0}, {0, 0, 0}, {223, 113, 38}, {244, 225, 207}, 
{223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {223, 113, 38}, {0, 0, 0}, {0, 0, 0}, {210, 100, 26}, {0, 0, 0}, 
{55, 148, 110}, {223, 113, 38}, {55, 148, 110}, {223, 113, 38}, {0, 0, 0}, {0, 0, 0}, {210, 100, 26}, {0, 0, 0}, 
{223, 113, 38}, {255, 179, 231}, {223, 113, 38}, {223, 113, 38}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {0, 0, 0}, 
{0, 0, 0}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {210, 100, 26}, {0, 0, 0}, {0, 0, 0}, 
{0, 0, 0}, {255, 255, 255}, {0, 0, 0}, {255, 255, 255}, {0, 0, 0}, {210, 100, 26}, {0, 0, 0}, {0, 0, 0}};
//LED ARRAY

void setup() { 
  //RFID
  Serial.begin(9600);
  SPI.begin(); // Init SPI bus
  rfid.PCD_Init(); // Init MFRC522 
  for (byte i = 0; i < 6; i++) {
    key.keyByte[i] = 0xFF;
  }
  //RFID

  //LED ARRAY
  FastLED.addLeds<WS2812B,DATA_PIN,GRB>(leds,NUM_LEDS).setRgbw(RgbwDefault());
  FastLED.setBrightness(64);
  FastLED.show();
  //LED ARRAY
 
}
 
void loop() {
  
  //RFID
  // Look for new cards
  if ( ! rfid.PICC_IsNewCardPresent()) return;
  // Verify if the NUID has been readed
  if ( ! rfid.PICC_ReadCardSerial()) return;
  for (byte i = 0; i < 4; i++)
  {
    nuidPICC[i] = rfid.uid.uidByte[i];
  }
  //printHex(rfid.uid.uidByte, rfid.uid.size);
  //Serial.println();
  rfid.PICC_HaltA();
  rfid.PCD_StopCrypto1();
  //RFID

  //LED ARRAY CHANGING
  if(rfid.uid.uidByte[1] == knownKeys[0][1])
  {
    ChangeSymbol(Snake);
    Serial.println("Snake");
  }
  else if(rfid.uid.uidByte[1] == knownKeys[1][1])
  {
    ChangeSymbol(Turtle);
    Serial.println("Turtle");
  }
  else if(rfid.uid.uidByte[1] == knownKeys[2][1])
  {
    ChangeSymbol(Snail);
    Serial.println("Snail");
  }
  else if(rfid.uid.uidByte[1] == knownKeys[3][1])
  {
    ChangeSymbol(Fox);
    Serial.println("Fox");
  }
  else if(rfid.uid.uidByte[1] == knownKeys[4][1])
  {
    ChangeSymbol(Chicken);
    Serial.println("Chicken");
  }
  else if(rfid.uid.uidByte[1] == knownKeys[5][1])
  {
    ChangeSymbol(Cat);
    Serial.println("Cat");
  }
  //LED ARRAY CHANGING
  FastLED.show();
  delay(500);
}



/*void printHex(byte *buffer, byte bufferSize)
{
  for (byte i = 0; i < bufferSize; i++)
  {
    Serial.print(buffer[i] < 0x10 ? " 0" : " ");
    Serial.print(buffer[i], HEX);
  }
}*/


void ChangeSymbol(int symbol[NUM_LEDS][3])
{
  for (int i=0;i<NUM_LEDS;i++)
  {
    leds[i]=CRGB(symbol[i][0], symbol[i][1], symbol[i][2]);
  }
}